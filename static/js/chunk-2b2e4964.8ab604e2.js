(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b2e4964"],{"1eff":function(e,t,n){"use strict";n("30ba")},2759:function(e,t,n){},"2b18":function(e,t,n){"use strict";n("c08b")},"2e23":function(e,t,n){"use strict";n("2759")},"30ba":function(e,t,n){},"4fa5":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-form",{staticClass:"app-button-list",attrs:{inline:""}},e._l(e.bottonList,(function(t){return n("el-form-item",{key:t.label},[n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:t.icon,disabled:t.disabled},on:{click:function(e){return t.handle()}}},[e._v(e._s(t.label))])],1)})),1)],1),n("div",{staticClass:"filter-container"},[n("el-form",{attrs:{inline:!0,model:e.formOrg}},[n("el-row",[n("el-form-item",{attrs:{label:"組織物件ID"}},[n("el-input",{key:"OBJID",ref:"objInput",attrs:{disabled:e.OrgObjIDdisabled,maxlength:"8","show-word-limit":""},nativeOn:{keyup:[function(t){return e.Reset(t)},function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.getObjInfo(t)}]},model:{value:e.formOrg.OBJID,callback:function(t){e.$set(e.formOrg,"OBJID",t)},expression:"formOrg.OBJID"}})],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"組織代碼"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{disabled:e.OrgSHORTdisabled},model:{value:e.formOrg.SHORT,callback:function(t){e.$set(e.formOrg,"SHORT",t)},expression:"formOrg.SHORT"}})],1),n("el-col",{attrs:{span:11,offset:1}},[n("el-input",{attrs:{disabled:e.OrgSTEXTdisabled},model:{value:e.formOrg.STEXT,callback:function(t){e.$set(e.formOrg,"STEXT",t)},expression:"formOrg.STEXT"}})],1)],1)],1)],1)],1),n("div",{staticClass:"filter-container"},[n("el-form",{staticClass:"form-container",attrs:{inline:!0}},[n("el-row",[n("el-col",{attrs:{span:10}},[n("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:"",fit:"","highlight-current-row":"",height:"300"}},[n("el-table-column",{attrs:{label:"infotype"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:t.row.infotype},model:{value:e.infotypeSelected,callback:function(t){e.infotypeSelected=t},expression:"infotypeSelected"}},[e._v(e._s(t.row.infotype))])]}}])})],1)],1),n("el-col",{attrs:{span:10,offset:1}},[n("el-radio-group",{model:{value:e.typeinfoFromToFlg,callback:function(t){e.typeinfoFromToFlg=t},expression:"typeinfoFromToFlg"}},[n("el-row",[n("el-radio",{attrs:{label:1}},[e._v("期間")])],1),n("el-row",[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:"由:"}},[n("el-date-picker",{attrs:{size:"small",type:"date",format:"yyyy-MM-dd",placeholder:"開始日期"},model:{value:e.typeinfoFromDate,callback:function(t){e.typeinfoFromDate=t},expression:"typeinfoFromDate"}})],1),n("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"120px",label:"至:"}},[n("el-date-picker",{attrs:{size:"small",type:"date",format:"yyyy-MM-dd",placeholder:"結束日期"},model:{value:e.typeinfoToDate,callback:function(t){e.typeinfoToDate=t},expression:"typeinfoToDate"}})],1)],1),n("el-row",[n("el-radio",{attrs:{label:9}},[e._v("全部")])],1)],1)],1)],1)],1)],1),e.ObjDetailDialogVisible?n("div",[n("el-dialog",{attrs:{title:"物件 顯示",width:"80%",visible:e.ObjDetailDialogVisible,"before-close":e.handleClose,"show-close":!0,center:""},on:{"update:visible":function(t){e.ObjDetailDialogVisible=t}}},[n("object-detail",{attrs:{objid:e.formOrg.OBJID,begda:e.begda,endda:e.endda,mode:e.Mode,objguid:""}})],1)],1):e._e(),e.ObjListDialogVisible?n("div",[n("el-dialog",{attrs:{title:"物件 顯示列表",width:"80%",visible:e.ObjListDialogVisible,"before-close":e.handleClose,"show-close":!0,center:""},on:{"update:visible":function(t){e.ObjListDialogVisible=t}}},[n("object-list",{attrs:{objid:e.formOrg.OBJID,begda:e.begda,endda:e.endda,mode:e.Mode}})],1)],1):e._e()])},o=[],a=(n("b0c0"),n("99af"),n("7db0"),n("d3b7"),n("4e82"),n("4de4"),n("5c96")),l=n("b775");function s(e,t,n){var i="/DomainController/OM/Organizationl/O_HRP1000/Get/".concat(e,"/").concat(t,"/").concat(n);return Object(l["a"])({url:"http://tapihrs.cminl.oa2"+i,method:"get"})}function r(e,t,n){var i="/DomainController/OM/Organizationl/O_P1000/Get/".concat(e,"/").concat(t,"/").concat(n);return Object(l["a"])({url:"http://tapihrs.cminl.oa2"+i,method:"get"})}function d(e){var t="/DomainController/OM/Organizationl/O_HRP1000/editLock";return Object(l["a"])({url:"http://tapihrs.cminl.oa2"+t,method:"put",data:e})}function c(e){var t="/DomainController/OM/Organizationl/O_P1000";return Object(l["a"])({url:"http://tapihrs.cminl.oa2"+t,method:"put",data:e})}function f(e){var t="/DomainController/OM/Organizationl/O_P1000";return Object(l["a"])({url:"http://tapihrs.cminl.oa2"+t,method:"post",data:e})}function m(e){var t="/DomainController/OM/Organizationl/O_P1000/ActiveUpdate";return Object(l["a"])({url:"http://tapihrs.cminl.oa2"+t,method:"put",data:e})}function b(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate())}function u(e){return"".concat(e.getFullYear(),"-").concat(e.getMonth()+1,"-").concat(e.getDate()," ").concat(e.getHours(),":").concat(e.getMinutes(),":").concat(e.getSeconds())}var h=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-form",{staticClass:"app-button-list",attrs:{inline:""}},e._l(e.bottonList,(function(t){return n("el-form-item",{key:t.label},[n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:t.icon,disabled:t.disabled},on:{click:function(e){return t.handle()}}},[e._v(e._s(t.label))])],1)})),1)],1),n("div",{staticClass:"filter-container"},[n("el-form",{attrs:{inline:!0,model:e.formInline}},[n("el-row",[n("el-form-item",{attrs:{label:"組織代碼"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{placeholder:"SHORT",disabled:!0},model:{value:e.formInline.SHORT,callback:function(t){e.$set(e.formInline,"SHORT",t)},expression:"formInline.SHORT"}})],1),n("el-col",{attrs:{span:11,offset:1}},[n("el-input",{attrs:{placeholder:"STEXT",disabled:!0},model:{value:e.formInline.STEXT,callback:function(t){e.$set(e.formInline,"STEXT",t)},expression:"formInline.STEXT"}})],1)],1)],1)],1)],1),n("div",{staticClass:"filter-container"},[n("el-form",{staticClass:"form-container",attrs:{inline:!0}},[n("el-row",[n("el-col",[n("el-table",{staticStyle:{width:"72%"},attrs:{data:e.tableData,border:"",fit:"","highlight-current-row":"",height:"300"}},[n("el-table-column",{attrs:{label:"開始日期",width:"180"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-radio",{attrs:{label:t.row.id},nativeOn:{change:function(n){return e.getCurrentRow(t.row)}},model:{value:e.rowSelected,callback:function(t){e.rowSelected=t},expression:"rowSelected"}},[e._v(e._s(t.row.begda))])]}}])}),n("el-table-column",{attrs:{prop:"endda",label:"結束日期",width:"180"}}),n("el-table-column",{attrs:{prop:"short",label:"組織代碼",width:"180"}}),n("el-table-column",{attrs:{prop:"stext",label:"組織名稱",width:"180"}})],1)],1)],1)],1)],1),e.ObjDetailDialogVisible?n("div",[n("el-dialog",{attrs:{title:"物件 顯示",width:"80%","modal-append-to-body":!1,visible:e.ObjDetailDialogVisible,"before-close":e.handleClose,"show-close":!0},on:{"update:visible":function(t){e.ObjDetailDialogVisible=t}}},[n("object-detail",{attrs:{objid:e.objid,begda:e.begda,endda:e.endda,mode:e.NewMode,objdata:e.sel_objdata,objguid:e.OBJGUID}})],1)],1):e._e()])},p=[],g=(n("159b"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"filter-container"},[n("el-form",{staticClass:"app-button-list",attrs:{inline:""}},e._l(e.bottonList,(function(t){return n("el-form-item",{key:t.label},[["Edit","Add","Copy"].includes(e.mode)?[n("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:t.icon,disabled:t.disabled},on:{click:function(e){return t.handle()}}},[e._v(e._s(t.label))])]:e._e()],2)})),1)],1),n("div",{staticClass:"filter-container"},[n("el-form",{attrs:{inline:!0,model:e.formInline}},[["View","ViewByGUID","Edit"].includes(e.mode)?[n("el-row",[n("el-form-item",{attrs:{label:"組織代碼"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{placeholder:"SHORT",disabled:!0},model:{value:e.formInline.SHORT,callback:function(t){e.$set(e.formInline,"SHORT",t)},expression:"formInline.SHORT"}})],1),n("el-col",{attrs:{span:11,offset:1}},[n("el-input",{attrs:{placeholder:"STEXT",disabled:!0},model:{value:e.formInline.STEXT,callback:function(t){e.$set(e.formInline,"STEXT",t)},expression:"formInline.STEXT"}})],1)],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"有效性"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{placeholder:"BEGDA",disabled:!0},model:{value:e.formInline.BEGDA,callback:function(t){e.$set(e.formInline,"BEGDA",t)},expression:"formInline.BEGDA"}})],1),n("el-col",{attrs:{span:11,offset:1}},[n("el-input",{attrs:{placeholder:"ENDDA",disabled:!0},model:{value:e.formInline.ENDDA,callback:function(t){e.$set(e.formInline,"ENDDA",t)},expression:"formInline.ENDDA"}})],1)],1)],1),n("el-row",[n("el-form-item",{attrs:{label:"更改資訊"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{placeholder:"UNAME",disabled:!0},model:{value:e.formInline.UNAME,callback:function(t){e.$set(e.formInline,"UNAME",t)},expression:"formInline.UNAME"}})],1),n("el-col",{attrs:{span:11,offset:1}},[n("el-input",{attrs:{placeholder:"AEDTM",disabled:!0},model:{value:e.formInline.AEDTM,callback:function(t){e.$set(e.formInline,"AEDTM",t)},expression:"formInline.AEDTM"}})],1)],1)],1)]:e._e(),["Edit","Add","Copy"].includes(e.mode)?[n("el-row",[n("el-col",{attrs:{span:11}},[n("el-form-item",{attrs:{label:"組織代碼(新)"}},[n("el-input",{attrs:{disabled:!1,maxlength:"12","show-word-limit":""},model:{value:e.formInline.SHORT_NEW,callback:function(t){e.$set(e.formInline,"SHORT_NEW",t)},expression:"formInline.SHORT_NEW"}})],1)],1),n("el-col",{attrs:{span:11}},[n("el-form-item",{attrs:{label:"組織名稱(新)"}},[n("el-input",{attrs:{disabled:!1,maxlength:"40","show-word-limit":""},model:{value:e.formInline.STEXT_NEW,callback:function(t){e.$set(e.formInline,"STEXT_NEW",t)},expression:"formInline.STEXT_NEW"}})],1)],1)],1)]:e._e(),["Add","Copy"].includes(e.mode)?[n("el-row",[n("el-col",{attrs:{span:11}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"開始時間(新)"}},[n("el-date-picker",{attrs:{size:"small",type:"date",format:"yyyy-MM-dd",placeholder:"開始日期"},model:{value:e.formInline.BEGDA_NEW,callback:function(t){e.$set(e.formInline,"BEGDA_NEW",t)},expression:"formInline.BEGDA_NEW"}})],1)],1),n("el-col",{attrs:{span:11}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"結束時間(新)"}},[n("el-date-picker",{attrs:{size:"small",type:"date",format:"yyyy-MM-dd",placeholder:"結束日期"},model:{value:e.formInline.ENDDA_NEW,callback:function(t){e.$set(e.formInline,"ENDDA_NEW",t)},expression:"formInline.ENDDA_NEW"}})],1)],1)],1)]:e._e(),["Add","Copy"].includes(e.mode)?[n("el-row",[n("el-col",{attrs:{span:11}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"更改人員(新)"}},[n("el-input",{attrs:{disabled:!0},model:{value:e.formInline.UNAME_NEW,callback:function(t){e.$set(e.formInline,"UNAME_NEW",t)},expression:"formInline.UNAME_NEW"}})],1)],1),n("el-col",{attrs:{span:11}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"更改時間(新)"}},[n("el-input",{attrs:{disabled:!0},model:{value:e.formInline.AEDTM_NEW,callback:function(t){e.$set(e.formInline,"AEDTM_NEW",t)},expression:"formInline.AEDTM_NEW"}})],1)],1)],1)]:e._e(),["Add","Copy"].includes(e.mode)?[n("el-row",[n("el-col",{attrs:{span:11}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"Infotype(新)"}},[n("el-input",{attrs:{disabled:!1,maxlength:"4","show-word-limit":""},model:{value:e.formInline.INFTY_NEW,callback:function(t){e.$set(e.formInline,"INFTY_NEW",t)},expression:"formInline.INFTY_NEW"}})],1)],1),n("el-col",{attrs:{span:11}},[n("el-form-item",{staticClass:"postInfo-container-item",attrs:{label:"子類型(新)"}},[n("el-input",{attrs:{disabled:!1,maxlength:"4","show-word-limit":""},model:{value:e.formInline.SUBTY_NEW,callback:function(t){e.$set(e.formInline,"SUBTY_NEW",t)},expression:"formInline.SUBTY_NEW"}})],1)],1)],1)]:e._e()],2)],1)])}),D=[],O=(n("498a"),n("25f0"),{name:"ObjectDetail",components:{},props:{objid:{type:String,default:""},mode:{type:String,default:""},begda:{type:String,default:""},endda:{type:String,default:""},objguid:{type:String,default:"",required:!1},objdata:{type:Object,default:function(){return{message:"hello"}},required:!1}},data:function(){var e=this;return{bottonList:[{label:"儲存",icon:"el-icon-receiving",disabled:!1,handle:function(){e.Save()}}],formInline:{SHORT:"",STEXT:"",BEGDA:"",ENDDA:"",UNAME:"",AEDTM:"",SHORT_NEW:"",STEXT_NEW:"",BEGDA_NEW:"",ENDDA_NEW:"",UNAME_NEW:"",AEDTM_NEW:"",INFTY_NEW:"",SUBTY_NEW:""},OBJGUID:""}},computed:{},created:function(){var e=this;return console.log("mode: "+this.mode),"Add"===this.mode?(this.formInline.ENDDA_NEW="9999-12-31",this.formInline.UNAME_NEW=this.$store.getters.name,void(this.formInline.AEDTM_NEW=b(new Date))):"Copy"===this.mode?(this.formInline.SHORT_NEW=this.objdata.short,this.formInline.STEXT_NEW=this.objdata.stext,this.formInline.BEGDA_NEW=this.objdata.begda,this.formInline.ENDDA_NEW=this.objdata.endda,this.formInline.UNAME_NEW=this.$store.getters.name,void(this.formInline.AEDTM_NEW=b(new Date))):"ViewByGUID"===this.mode||"Edit"===this.mode&&this.objguid.length>0?(this.formInline.SHORT=this.objdata.short,this.formInline.STEXT=this.objdata.stext,this.formInline.BEGDA=this.objdata.begda,this.formInline.ENDDA=this.objdata.endda,this.formInline.UNAME=this.objdata.uname,this.formInline.AEDTM=this.objdata.aedtm,void(this.OBJGUID=this.objdata.id)):(console.log("getObjInfo param: "+this.objid+", "+this.begda+", "+this.endda),void r(this.objid,this.begda,this.endda).then((function(t){var n=t.data;if(n.length>0){n.sort((function(e,t){return new Date(t.endda)-new Date(e.endda)}));var i=n.filter((function(t){return"1"===t.active&&(new Date(t.begda)<=new Date(e.endda)||new Date(t.endda)>=new Date(e.begdada))}));i.length>0?(e.formInline.SHORT=i[0].short,e.formInline.STEXT=i[0].stext,e.formInline.BEGDA=i[0].begda,e.formInline.ENDDA=i[0].endda,e.formInline.UNAME=i[0].uname,e.formInline.AEDTM=i[0].aedtm,e.OBJGUID=i[0].id):Object(a["Message"])({message:"Active物件資訊取得為空白",type:"error",duration:3e3})}else Object(a["Message"])({message:"物件資訊取得為空白",type:"error",duration:3e3})})).catch((function(e){console.log(e)})))},methods:{Save:function(){if("Edit"===this.mode){var e={};if(e.id=this.OBJGUID,e.objid=this.objid,e.begda=b(new Date(this.formInline.BEGDA)),e.endda=b(new Date(this.formInline.ENDDA)),e.uname=this.$store.getters.name,e.aedtm=b(new Date),e.short=this.formInline.SHORT_NEW,e.stext=this.formInline.STEXT_NEW,0===this.formInline.SHORT_NEW.trim().length||0===this.formInline.STEXT_NEW.trim().length)return void Object(a["Message"])({message:"物件縮寫及名稱不能室空白",type:"warning",duration:3e3});c(e).then((function(e){var t=e.success;void 0!==t&&!0===t?Object(a["Message"])({message:"物件更新成功",type:"success",duration:3e3}):(console.log("updateObjInfo Reply is error"),Object(a["Message"])({message:"物件更新回復異常",type:"error",duration:3e3}))})).catch((function(e){console.log(e)}))}else if("Add"===this.mode||"Copy"===this.mode){var t={};if(console.log("this.formInline.BEGDA_NEW"+this.formInline.BEGDA_NEW),0===this.formInline.SHORT_NEW.trim().length||0===this.formInline.STEXT_NEW.trim().length||null===this.formInline.BEGDA_NEW||null===this.formInline.ENDDA_NEW||0===this.formInline.BEGDA_NEW.toString().trim().length||0===this.formInline.ENDDA_NEW.toString().trim().length||0===this.formInline.INFTY_NEW.trim().length||0===this.formInline.SUBTY_NEW.trim().length)return void Object(a["Message"])({message:"物件縮寫/名稱/開始結束日期/Infotype/子類型不能室空白",type:"warning",duration:3e3});t.id="",t.objid=this.objid,t.begda=b(new Date(this.formInline.BEGDA_NEW)),t.endda=b(new Date(this.formInline.ENDDA_NEW)),t.uname=this.$store.getters.name,t.aedtm=b(new Date),t.short=this.formInline.SHORT_NEW,t.stext=this.formInline.STEXT_NEW,t.infty=this.formInline.INFTY_NEW,t.subty=this.formInline.SUBTY_NEW,t.active="1",f(t).then((function(e){var t=e.success;void 0!==t&&!0===t?Object(a["Message"])({message:"物件更新成功",type:"success",duration:3e3}):(console.log("updateObjInfo Reply is error"),Object(a["Message"])({message:"物件更新回復異常",type:"error",duration:3e3}))})).catch((function(e){console.log(e)}))}else Object(a["Message"])({message:"未定義此操作功能，請聯繫MIS",type:"error",duration:3e3})}}}),E=O,I=(n("2e23"),n("2877")),y=Object(I["a"])(E,g,D,!1,null,"580a2bf8",null),T=y.exports,v={name:"ObjectList",components:{ObjectDetail:T},props:{objid:{type:String,default:""},mode:{type:String,default:""},begda:{type:String,default:""},endda:{type:String,default:""}},data:function(){var e=this;return{bottonList:[{label:"新增",icon:"el-icon-document-add",disabled:!0,handle:function(){e.Add()}},{label:"編輯",icon:"el-icon-edit",disabled:!0,handle:function(){e.Edit()}},{label:"複製",icon:"el-icon-document-copy",disabled:!0,handle:function(){e.Copy()}},{label:"刪除",icon:"el-icon-delete",disabled:!0,handle:function(){e.Delete()}},{label:"顯示細節",icon:"el-icon-more",disabled:!1,handle:function(){e.ViewByGUID()}}],formInline:{SHORT:"",STEXT:""},tableData:[],OBJGUID:"",ObjDetailDialogVisible:!1,temp:{infotype:""},rowSelected:"",templateSelection:{},NewMode:""}},computed:{sel_objdata:function(){var e=this;return this.tableData.find((function(t){return t.id===e.rowSelected}))}},created:function(){"View"===this.mode?this.bottonList.forEach((function(e){e.disabled=!0})):this.bottonList.forEach((function(e){e.disabled=!1}));var e=this.bottonList.find((function(e){return"顯示細節"===e.label}));e.disabled=!1,this.getObjInfo()},methods:{getObjInfo:function(){var e=this;r(this.objid,this.begda,this.endda).then((function(t){var n=t.data;if(n.length>0){n.sort((function(e,t){return new Date(t.endda)-new Date(e.endda)}));var i=n.filter((function(t){return"1"===t.active&&new Date(t.begda)<=new Date(e.endda)&&new Date(t.endda)>=new Date(e.begda)}));i.length>0?(e.formInline.SHORT=i[0].short,e.formInline.STEXT=i[0].stext,e.OBJGUID=i[0].id,e.tableData=i):Object(a["Message"])({message:"Active物件資訊取得為空白",type:"error",duration:3e3})}else Object(a["Message"])({message:"物件資訊取得為空白",type:"error",duration:3e3})})).catch((function(e){console.log(e)}))},checkSelect:function(){return!!this.rowSelected||(Object(a["Message"])({message:"如下表格資料選擇不能為空 !",type:"error",duration:3e3}),!1)},Add:function(){this.NewMode="Add",this.ObjDetailDialogVisible=!0},Edit:function(){this.checkSelect()&&(this.NewMode="Edit",this.ObjDetailDialogVisible=!0)},Copy:function(){this.checkSelect()&&(this.NewMode="Copy",this.ObjDetailDialogVisible=!0)},Delete:function(){if(this.checkSelect()){var e={};e.id=this.sel_objdata.id,e.uname=this.$store.getters.name,e.aedtm=b(new Date),m(e).then((function(e){var t=e.success;void 0!==t&&!0===t?Object(a["Message"])({message:"物件刪除成功",type:"success",duration:3e3}):(console.log("deleteObjInfo Reply is null or false"),Object(a["Message"])({message:"物件刪除回復異常",type:"error",duration:3e3}))})).catch((function(e){console.log(e)})),this.NewMode="Delete",this.getObjInfo()}},ViewByGUID:function(){this.checkSelect()&&(this.NewMode="ViewByGUID",this.ObjDetailDialogVisible=!0)},handleClose:function(e){e(),this.getObjInfo()},getCurrentRow:function(e){this.templateSelection=e}}},w=v,j=(n("1eff"),Object(I["a"])(w,h,p,!1,null,"32af4856",null)),S=j.exports,N={name:"OrgHrp1000",components:{ObjectDetail:T,ObjectList:S},data:function(){var e=this;return{bottonList:[{label:"編輯/顯示",icon:"el-icon-view",disabled:!1,handle:function(){e.btnControlEditView()}},{label:"編輯",icon:"el-icon-edit",disabled:!0,handle:function(){e.btnControlEdit()}},{label:"顯示細節",icon:"el-icon-more",disabled:!1,handle:function(){e.btnControlView()}},{label:"顯示所有列表",icon:"el-icon-s-order",disabled:!1,handle:function(){e.btnControlViewList()}}],formOrg:{OBJID:"",SHORT:"",STEXT:""},OrgObjIDdisabled:!1,OrgSHORTdisabled:!0,OrgSTEXTdisabled:!0,tableData:[{infotype:"物件"},{infotype:"關係"},{infotype:"組織地點"},{infotype:"部門層級資料"},{infotype:"部門主管委任形式"},{infotype:"組織費用屬性"},{infotype:"部門屬性"},{infotype:"部門編制"},{infotype:"組織類型(編制/簽核/純簽核/平行)"},{infotype:"費用歸屬"},{infotype:"虛線呈報組織"}],infotypeSelected:"",typeinfoFromDate:new Date,typeinfoToDate:new Date(9999,11,31),typeinfoFromToFlg:1,infotypeSelcted:"",infotypeDlgSelected:"",ObjDetailDialogVisible:!1,ObjListDialogVisible:!1,Mode:"View",begda:"",endda:""}},computed:{},mounted:function(){this.$refs.objInput.focus()},beforeDestroy:function(){console.log("beforeDestroy");var e=this.formOrg.OBJID;if("Edit"===this.Mode){var t={};t.objid=e,t.mdfyflg="N",t.mdfyusr=this.$store.getters.name,t.mdfydtm=u(new Date),d(t).then((function(t){var n=t.success;!0===n||Object(a["Message"])({message:"檢視切換失敗:物件ID(".concat(e,")編輯解鎖失效"),type:"error",duration:3e3})})).catch((function(e){console.log(e)})),this.OrgObjIDdisabled=!1,this.Mode="View"}},methods:{btnControlEditView:function(){var e=this;if(this.formOrg.OBJID){var t=this.formOrg.OBJID;if("View"===this.Mode){var n=new Date,i="".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate()),o="".concat(n.getFullYear(),"-").concat(n.getMonth()+1,"-").concat(n.getDate());s(t,i,o).then((function(n){var i=n.data;if(void 0!==i.mdfyflg)if("1"===i.active){if("Y"===i.mdfyflg){if(i.mdfyusr!==e.$store.getters.name)return void Object(a["Message"])({message:"編輯切換失敗:物件ID(".concat(t,")正被(").concat(i.mdfyusr,")編輯").concat(i.mdfydtm),type:"error",duration:3e3});Object(a["Message"])({message:"歡迎重回編輯模式:上次編輯".concat(i.mdfydtm),type:"success",duration:3e3})}}else Object(a["Message"])({message:"編輯切換失敗:物件ID(".concat(t,")已失效"),type:"error",duration:3e3});else Object(a["Message"])({message:"編輯切換失敗:物件ID(".concat(t,")不存在主檔中"),type:"error",duration:3e3})})).catch((function(e){console.log(e)}));var l={objid:t,mdfyflg:"Y",mdfyusr:this.$store.getters.name,mdfydtm:u(new Date)};d(l).then((function(e){var n=e.success;!0===n?Object(a["Message"])({message:"編輯切換成功:物件ID(".concat(t,")已被編輯鎖定"),type:"success",duration:3e3}):Object(a["Message"])({message:"編輯切換失敗:物件ID(".concat(t,")編輯鎖定失敗"),type:"error",duration:3e3})})).catch((function(e){console.log(e)})),this.OrgObjIDdisabled=!0,this.Mode="Edit"}else{var r={};r.objid=t,r.mdfyflg="N",r.mdfyusr=this.$store.getters.name,r.mdfydtm=u(new Date),d(r).then((function(e){var n=e.success;!0===n||Object(a["Message"])({message:"檢視切換失敗:物件ID(".concat(t,")編輯解鎖失效"),type:"error",duration:3e3})})).catch((function(e){console.log(e)})),this.OrgObjIDdisabled=!1,this.Mode="View"}if("Edit"===this.Mode){var c=this.bottonList.find((function(e){return"編輯"===e.label}));c.disabled=!1;var f=this.bottonList.find((function(e){return"顯示細節"===e.label}));f.disabled=!0}else{var m=this.bottonList.find((function(e){return"編輯"===e.label}));m.disabled=!0;var b=this.bottonList.find((function(e){return"顯示細節"===e.label}));b.disabled=!1}}else Object(a["Message"])({message:"組織物件ID輸入不能為空 !",type:"error",duration:3e3})},btnControlEdit:function(e,t){this.showDialog(this.infotypeSelected,"Detail")},btnControlView:function(e,t){this.showDialog(this.infotypeSelected,"Detail")},btnControlViewList:function(){this.showDialog(this.infotypeSelected,"List")},Reset:function(e){this.formOrg.SHORT="",this.formOrg.STEXT=""},showDialog:function(e,t){this.formOrg.OBJID&&this.infotypeSelected?(1===this.typeinfoFromToFlg?(this.begda=b(this.typeinfoFromDate),this.endda=b(this.typeinfoToDate)):(this.begda="1900-01-01",this.endda="9999-12-31"),"物件"===e?"Detail"===t?this.ObjDetailDialogVisible=!0:"List"===t?this.ObjListDialogVisible=!0:Object(a["Message"])({message:"顯示類型未定義 !",type:"error",duration:3e3}):Object(a["Message"])({message:"infotype未定義 !",type:"error",duration:3e3})):Object(a["Message"])({message:"物件ID輸入及Infotype選擇不能為空 !",type:"error",duration:3e3})},handleClose:function(e){"Edit"===this.Mode?a["MessageBox"].confirm("確定離開編輯頁面 ?","注意",{confirmButtonText:"確定",cancelButtonText:"取消",type:"warning"}).then((function(t){e()})).catch((function(e){})):e()},getObjInfo:function(e){var t=this;if(this.formOrg.OBJID){var n=this.formOrg.OBJID;1===this.typeinfoFromToFlg?(this.begda=b(this.typeinfoFromDate),this.endda=b(this.typeinfoToDate)):(this.begda="1900-01-01",this.endda="9999-12-31"),console.log("getObjInfo param: "+n+", "+this.begda+", "+this.endda),r(n,this.begda,this.endda).then((function(e){var n=e.data;if(n.length>0){n.sort((function(e,t){return new Date(t.endda)-new Date(e.endda)}));var i=n.filter((function(e){return"1"===e.active&&(new Date(e.begda)<=new Date(t.endda)||new Date(e.endda)>=new Date(t.begda))}));i.length>0?(t.formOrg.OBJID=i[0].objid,t.formOrg.SHORT=i[0].short,t.formOrg.STEXT=i[0].stext):Object(a["Message"])({message:"Active物件資訊取得為空白",type:"error",duration:3e3})}else Object(a["Message"])({message:"物件資訊取得為空白",type:"error",duration:3e3})})).catch((function(e){console.log(e)}))}else Object(a["Message"])({message:"物件ID輸入不能為空 !",type:"error",duration:3e3})}}},_=N,M=(n("2b18"),Object(I["a"])(_,i,o,!1,null,"3675f565",null));t["default"]=M.exports},"7db0":function(e,t,n){"use strict";var i=n("23e7"),o=n("b727").find,a=n("44d2"),l=n("ae40"),s="find",r=!0,d=l(s);s in[]&&Array(1)[s]((function(){r=!1})),i({target:"Array",proto:!0,forced:r||!d},{find:function(e){return o(this,e,arguments.length>1?arguments[1]:void 0)}}),a(s)},c08b:function(e,t,n){}}]);